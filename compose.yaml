name: Chatacter
services:
  App:
    image: ghcr.io/alphaspheredotai/chattr:latest@sha256:165c88020ccfa0a833345dc7ee5d0752957e90b1911abb1aa5a9bea5d1bba75b
    container_name: app
    depends_on:
      - VectorDatabase
      - VideoGenerator
      - VoiceGenerator
    volumes:
      - ./App:/app:rw
    environment:
      GROQ_API_KEY: ${GROQ_API_KEY}
    ports:
      - '0.0.0.0:8000:7860'
    restart: always
  VectorDatabase:
    image: qdrant/qdrant:latest@sha256:d122138f76868edba68d36cb0833139c1d1761f00f09e48e61f8314196e6a4c6
    container_name: vector_database
    volumes:
      - qdrant_storage:/qdrant/storage
    ports:
      - '0.0.0.0:6333:6333'
      - '0.0.0.0:6334:6334'
    restart: always
  VideoGenerator:
    image: ghcr.io/alphaspheredotai/visualizr:latest
    container_name: video_generator
    volumes:
      - ./VideoGenerator:/app:rw
    ports:
      - '0.0.0.0:8002:7860'
    restart: always
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities:
                - gpu
  VoiceGenerator:
    image: ghcr.io/alphaspheredotai/vocalizr:latest@sha256:ac037f8eec97633dd25a8c30dba3caf2421d8ac4af5d7e1358cbbd82fbf46fd7
    container_name: voice_generator
    volumes:
      - huggingface:/home/app/hf
      - ./results/voice_generator:/home/app/results
      - ./logs/voice_generator:/home/app/logs
    environment:
      GRADIO_SERVER_PORT: 7860
    ports:
      - '0.0.0.0:8001:7860'
    restart: always
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: all
              capabilities:
                - gpu
volumes:
  huggingface:
